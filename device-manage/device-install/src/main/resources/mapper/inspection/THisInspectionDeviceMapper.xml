<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.smart.device.install.mapper.inspection.THisInspectionDeviceMapper">


    <select id="hisInspectionRepairList" resultType="com.smart.device.common.install.entity.THisInspectionDevice">
        SELECT t.inspection_id as inspectionId ,t.device_name as deviceName ,t.building_floor as buildingFloor  ,t.building_name as buildingName, t.device_question as deviceQuestion, t.device_status as deviceStatus,b.point_repair as pointRepair from t_his_inspection_device t ,t_his_inspection  b where b. inspection_id = t.inspection_id and device_status=2
        <if test="inspectionId != null ">
            and t.inspection_id = #{inspectionId}
        </if>
    </select>

    <select id="hisInspectionReplaceList" resultType="com.smart.device.common.install.entity.THisInspectionDevice">
        SELECT t.inspection_id as inspectionId ,device_name as deviceName ,building_floor as buildingFloor  ,building_name as buildingName , device_question,device_status, b.point_replace as pointReplace from t_his_inspection_device t ,t_his_inspection  b where b. inspection_id = t.inspection_id and device_status=3
        <if test="inspectionId != null ">
            and t.inspection_id = #{inspectionId}
        </if>
    </select>

    <select id="hisInspectionLoseList" resultType="com.smart.device.common.install.entity.THisInspectionDevice">
        SELECT t.inspection_id as inspectionId ,device_name as deviceName , building_floor as buildingFloor  ,building_name as buildingName, device_question,device_status ,b.point_lose as pointLost  from t_his_inspection_device t, t_his_inspection  b where b. inspection_id = t.inspection_id and device_status=4
        <if test="inspectionId != null ">
            and t.inspection_id = #{inspectionId}
        </if>
    </select>

    <select id="selectByIds" resultType="com.smart.device.common.install.entity.THisInspection"
     parameterType="java.lang.Long">
        SELECT t.company_name as companyName ,t.inspection_id as inspectionId, point , b.phone , b.name,t.create_time as createTime from t_his_inspection t ,t_base_firefighter b where b.id=t.firefighter_id
        <if test="inspectionId != null ">
            and inspection_id = #{inspectionId}
        </if>
    </select>

    <select id="selectId" resultType= "com.smart.device.common.install.entity.THisInspectionDevice"
            parameterType="java.lang.Long">
        SELECT * from  t_his_inspection_device
        where 1=1
        <if test="id != null ">
            and id = #{id}
        </if>
    </select>

    <insert id="insertOne" parameterType="com.smart.device.common.install.entity.THisInspectionDTO">
    insert into t_his_inspection_device(id, companyId, companyName, firefihtergId, firefighterNamePhone,firefighterName,point,pointRepair,pointReplace,pointLose,inspectionId,createTime,deleteFlag)
    values(#{id}, #{companyId}, #{companyName}, #{firefihtergId}, #{firefighterNamePhone}, #{firefighterName},#{point},#{pointRepair},#{pointReplace},#{pointLose},#{inspectionId},#{createTime},#{deleteFlag})
</insert>

    <update id="UpdateByIds" >
		update t_his_inspection_device
		set device_status = #{tHisInspectionDevice.deviceStatus}
      where id = #{tHisInspectionDevice.id}
	</update>



</mapper>
